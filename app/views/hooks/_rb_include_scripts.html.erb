<!-- rb_include_scripts -->
<%= stylesheet_link_tag 'jquery/jquery.jqplot.min.css', :plugin => 'redmine_backlogs' %>
<script type="text/javascript">
  if (!window.RB) var RB={}; //declare namespace early
  if (window.$) RB.old$ = $; //remember
</script>
<%= if (! ((Redmine::VERSION::MAJOR == 2) && (Redmine::VERSION::MINOR >= 1)) || 
          (Redmine::VERSION::MAJOR > 2)
       ) || (controller.is_a? RbApplicationController)
      javascript_include_tag(
        'jquery/jquery-1.6.2.min.js',
        'jquery/jquery-ui-1.8.16.custom.min.js',
        :plugin => 'redmine_backlogs')
    end
%>
<%= javascript_include_tag 'jquery/jquery.jeditable.mini.js', :plugin => 'redmine_backlogs' %>
<%= javascript_include_tag 'jquery/jquery.scrollfollow.js', :plugin => 'redmine_backlogs' %>
<!--[if IE]>
<%= javascript_include_tag 'jquery/jquery.jqplot/excanvas.js', :plugin => 'redmine_backlogs' %>
<![endif]-->
<%= javascript_include_tag('jquery/jquery.jqplot/jquery.jqplot.js',
      'jquery/jquery.jqplot/plugins/jqplot.highlighter.js',
      'jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.min.js',
      'jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.min.js',
      'jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.min.js',
      'jquery/jquery.jqplot/plugins/jqplot.dateAxisRenderer.min.js',
      'jquery/jquery.cookie.js',
      :plugin => 'redmine_backlogs') %>

<%# render the javascript_include_tags which must come before noConflict %>
<%= controller.rb_jquery_plugins if controller.respond_to?('rb_jquery_plugins') %>
<script type="text/javascript">
/* It is utterly important that this script comes AFTER any 2nd party jquery plugins */
if (!RB.$) { 
  RB.$ = jQuery.noConflict(true);//completely restore redmines jquery
  //provide compat for library callbacks. jquery.cookie does not work properly otherwise.
  if (!window.$) { // restore $ to redmine original (jquery 2.1+ or prototype 2.0) or make it jquery if not a redmine view.
    $ = RB.old$ || RB.$;
  }
  if (!window.jQuery) { // restore jQuery to redmine if it was jQuery in the first place (2.1+) or use backlogs (2.0)
    jQuery = ((RB.old$ && RB.old$.fn && typeof(RB.old$.fn.jquery) == "string") ? RB.old$ : RB.$);
  }
}
</script>
<script type="text/javascript"
        src="<%= url_for(:controller => 'rb_server_variables',
                         :action => 'index', :format => 'js') %>">
</script>
<%= javascript_include_tag 'common.js', 'burndown.js', :plugin => 'redmine_backlogs' %>
